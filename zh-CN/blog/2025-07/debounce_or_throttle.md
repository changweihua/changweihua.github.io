---
lastUpdated: true
commentabled: true
recommended: true
title: æ¯å¤©éƒ½åœ¨ç”¨çš„ debounce å’Œ throttleï¼Œå…¶å® 80% çš„ç”¨æ³•éƒ½é”™äº†
description: æ¯å¤©éƒ½åœ¨ç”¨çš„ debounce å’Œ throttleï¼Œå…¶å® 80% çš„ç”¨æ³•éƒ½é”™äº†
date: 2025-07-23 16:25:00 
pageClass: blog-page-class
cover: /covers/vue.svg
---

> â€œæˆ‘çŸ¥é“ debounce æ˜¯é˜²æŠ–ï¼Œthrottle æ˜¯èŠ‚æµï¼Œä¸å°±æ˜¯ lodash é‚£ä¸¤ä¸ªæ–¹æ³•å—ï¼Ÿâ€

å¦‚æœä½ ä¹Ÿæ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œé‚£ä½ å¯èƒ½å·²ç»åœ¨é¡¹ç›®ä¸­è¸©äº†æ— æ•°å‘ï¼Œè€Œè‡ªå·±è¿˜æµ‘ç„¶ä¸è§‰ã€‚

é˜²æŠ–å’ŒèŠ‚æµçš„æœ¬è´¨ï¼Œä»æ¥å°±ä¸åªæ˜¯â€œæ§åˆ¶è§¦å‘é¢‘ç‡â€è¿™ä¹ˆç®€å•ã€‚**çœŸæ­£çš„éš¾ç‚¹æ˜¯ï¼šæ—¶æœºæ§åˆ¶ã€å‰¯ä½œç”¨å¤„ç†ã€ä¸ä¸šåŠ¡åœºæ™¯çš„å¥‘åˆåº¦ï¼Œä»¥åŠåœ¨æ¡†æ¶ï¼ˆReact/Vueï¼‰ä¸­çš„æ­£ç¡®å§¿åŠ¿**ã€‚

è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘è®²å¤§ç™½è¯ï¼Œå¸¦ä½ é‡æ–°è®¤è¯† debounce å’Œ throttleï¼Œå¹¶ç”¨å¤šä¸ªçœŸå®åœºæ™¯å‘Šè¯‰ä½ ï¼š*å¤§å¤šæ•°äººç”¨é”™çš„ï¼Œä¸æ˜¯å‡½æ•°ï¼Œè€Œæ˜¯åœºæ™¯*ã€‚

## é˜²æŠ–ä¸èŠ‚æµçš„æ ¸å¿ƒåŒºåˆ« ##

å¾ˆå¤šæ–‡ç« å–œæ¬¢è¿™ä¹ˆå†™ï¼š

- debounceï¼ˆé˜²æŠ–ï¼‰ï¼š*N ç§’å†…åªæ‰§è¡Œæœ€åä¸€æ¬¡*
- throttleï¼ˆèŠ‚æµï¼‰ï¼š*N ç§’å†…æœ€å¤šæ‰§è¡Œä¸€æ¬¡*

è¿™äº›è¯å¯¹ï¼Œä½†ä¸å¤Ÿç”¨ã€‚æˆ‘ä»¬æ¢ä¸ªå·¥ç¨‹å¸ˆè§†è§’ï¼š

| ç‰¹æ€§   |   debounce     |   throttle |  å¤‡æ³¨ |
| :----------: | :----------: | :---------: | :-------: |
| è§¦å‘æ§åˆ¶ | å»¶è¿Ÿè§¦å‘ï¼ŒæŒç»­æ‰“æ–­  | å®šæœŸè§¦å‘ï¼Œä¸å—æ‰“æ–­ |  |
| åœºæ™¯å¼ºè°ƒ | é˜²æ­¢**è¿‡åº¦è§¦å‘** | ä¿è¯**æŒç»­å“åº”** |  |
| å¸¸ç”¨åœºæ™¯ | è¾“å…¥æ¡†æœç´¢ã€resizeã€scroll ç»“æŸ  | æ»šåŠ¨ç›‘å¬ã€é¼ æ ‡æ‹–åŠ¨ã€çª—å£ resize å®æ—¶æ›´æ–° |  |

ä¸¾ä¸ªä¾‹å­ä½ å°±æ‡‚äº†ï¼š

- **é˜²æŠ– debounce** é€‚åˆâ€œ**ç­‰ä½ è¯´å®Œæˆ‘å†å¤„ç†**â€
  - æ¯”å¦‚æœç´¢æ¡†è¾“å…¥ï¼Œä¸æƒ³æ¯æ¬¡æ•²å­—å°±è¯·æ±‚ APIã€‚

- **èŠ‚æµ throttle** é€‚åˆâ€œ**æˆ‘å®šæ—¶é‡‡é›†ä¿¡æ¯**â€
  - æ¯”å¦‚ç”¨æˆ·æ‹–åŠ¨åœ°å›¾æ—¶ï¼Œå®šæ—¶è·å–å½“å‰ä¸­å¿ƒç‚¹ã€‚

## ä½ çœŸçš„å†™å¯¹ debounce å—ï¼Ÿ ##

è¿™æ‰æ˜¯æ­£ç¡®çš„ debounceï¼š 

```js
function debounce(fn, delay) {
  let timer = null;
  return function (...args) {
    clearTimeout(timer);
    timer = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
}
```

ä½†é‡ç‚¹ä¸æ˜¯è¿™æ®µä»£ç ï¼Œè€Œæ˜¯ä¸‹é¢è¿™å‡ ç‚¹ä½¿ç”¨æ³¨æ„ï¼š

### âŒ é”™è¯¯ç”¨æ³•ï¼šåœ¨ç»„ä»¶å¤–éƒ¨å£°æ˜ debounce å‡½æ•° ###

```js
const search = debounce((val) => fetchData(val), 500);
<input onInput={(e) => search(e.target.value)} />
```

çœ‹èµ·æ¥å¾ˆæ ‡å‡†å¯¹å§ï¼Ÿ**âŒé”™ï¼**

å¦‚æœä½ åœ¨ `React/Vue` çš„ç»„ä»¶ä¸­è¿™ä¹ˆç”¨ï¼Œå°±ä¼šå‡ºç°é—­åŒ…å¼•ç”¨è¿‡æœŸã€çŠ¶æ€æ— æ³•åŒæ­¥çš„é—®é¢˜ã€‚

### âœ… æ­£ç¡®ç”¨æ³•ï¼šå°† debounce æ”¾å…¥ `useCallback` / `onMounted` ä¸­æ³¨å†Œ ###


::: code-group

```js [React]
const search = useCallback(
  debounce((val) => fetchData(val), 500),
  []
);
```
```js [Vue]
setup() {
  const search = debounce((val) => fetchData(val), 500);
  return { search };
}
```
:::

## throttle ä¸èƒ½æ»¥ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨åŠ¨ç”»ä¸­ ##

çœ‹çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š

```js
window.addEventListener('scroll', throttle(handleScroll, 100));
```

> å¬èµ·æ¥å¥½åƒæŒºå¯¹ï¼Ÿä½†å¦‚æœä½ åœ¨é¡µé¢ä¸Šå®ç°åŠ¨ç”»æˆ–æ‡’åŠ è½½ï¼Œç”¨æˆ·æ»šåŠ¨é£å¿«æ—¶ï¼Œå†…å®¹æ ¹æœ¬æ¥ä¸åŠåŠ è½½å®Œã€‚

ä¸ºä»€ä¹ˆï¼Ÿ**å› ä¸º throttle ä¼šé™åˆ¶å“åº”é¢‘ç‡ï¼Œå¯¼è‡´ UI ä¸æµç•…**ã€‚

### æ­£ç¡®åšæ³•æ˜¯â€”â€”ä½¿ç”¨ `requestAnimationFrame` æ›¿ä»£ throttle ###

```js
let ticking = false;
window.addEventListener('scroll', () => {
  if (!ticking) {
    requestAnimationFrame(() => {
      handleScroll();
      ticking = false;
    });
    ticking = true;
  }
});
```

è¿™ç§åšæ³•è¢«ç§°ä¸º â€œåŸºäºå¸§èŠ‚æµâ€ï¼Œæ›´å¹³æ»‘ï¼Œé€‚åˆ UI æ€§èƒ½åœºæ™¯ã€‚

## é«˜çº§åœºæ™¯ï¼šä½ è€ƒè™‘è¿‡ç«‹å³æ‰§è¡Œï¼ˆleadingï¼‰å’Œå»¶è¿Ÿæ‰§è¡Œï¼ˆtrailingï¼‰å—ï¼Ÿ ##

`lodash` çš„ `debounce` æ”¯æŒå‚æ•° `{ leading: true, trailing: false }`ï¼š

```js
const fn = debounce(() => console.log('run'), 1000, { leading: true });
```

**è§£é‡Š**ï¼š

- `leading: true`ï¼šç¬¬ä¸€æ¬¡ç«‹åˆ»æ‰§è¡Œ
- `trailing: true`ï¼šç»“æŸåå†æ‰§è¡Œä¸€æ¬¡

å¾ˆå¤šäººé»˜è®¤ trailing=trueï¼Œä½†åœ¨æŸäº›æ“ä½œä¸­ï¼Œå¦‚â€œæŒ‰é’®ç‚¹å‡»é˜²è¿ç‚¹â€ï¼Œä½ åº”è¯¥åªå…è®¸ **leading:trueï¼Œtrailing:false**ã€‚

```js
const handleClick = debounce(() => doSomething(), 2000, {
  leading: true,
  trailing: false
});
```

é¿å…æŒ‰é’®åœ¨çŸ­æ—¶é—´å†…è¢«è¿ç»­è§¦å‘ï¼Œä½†ç¬¬ä¸€ä¸‹ä»ç«‹å³å“åº”ã€‚

## ä¸€æ¬¡çœŸå®çš„ä¸šåŠ¡è¸©å‘ï¼šæœç´¢æ¥å£è¯·æ±‚ä¸¢å¤± ##

ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™ç§é—®é¢˜ï¼š

- è¾“å…¥å¾ˆå¿«æ—¶ï¼Œæœç´¢è¯·æ±‚ Aã€Bã€C åŒæ—¶è§¦å‘
- æœ€å C è¯·æ±‚æ…¢ï¼ŒA åè€Œå…ˆå›æ¥äº†
- é¡µé¢ç»“æœå´è¢« A çš„ç»“æœè¦†ç›–äº†

> è¿™æ—¶å€™ï¼Œä½ ç”¨ debounce æ ¹æœ¬æ²¡ç”¨ï¼

ä½ éœ€è¦çš„æ˜¯ï¼š**è¯·æ±‚å»æŠ– + å“åº”ä¹±åºä¿æŠ¤ï¼ˆé˜²æŠ–+é˜²ä¹±åºï¼‰**

```js
let lastCallId = 0;

const search = debounce(async (val) => {
  const callId = ++lastCallId;
  const res = await fetchSearch(val);
  if (callId === lastCallId) {
    renderResult(res);
  }
}, 300);
```

## è‡ªå®šä¹‰ debounce + å–æ¶ˆèƒ½åŠ› ##

```js
function debounce(fn, delay) {
  let timer;
  const debounced = function (...args) {
    clearTimeout(timer);
    timer = setTimeout(() => fn.apply(this, args), delay);
  };
  debounced.cancel = () => clearTimeout(timer);
  return debounced;
}
```

åœ¨ `React` çš„ `useEffect` æ¸…ç†ä¸­ä½¿ç”¨ï¼š

```js
useEffect(() => {
  const fn = debounce(doSearch, 300);
  fn();
  return () => fn.cancel();
}, [searchKey]);
```

é¿å…ç»„ä»¶é”€æ¯åè¿˜è§¦å‘ debounce çš„å›è°ƒã€‚

## é¢è¯•åŠ åˆ†é¢˜ï¼šé˜²æŠ–/èŠ‚æµä¸ºä»€ä¹ˆå®¹æ˜“äº§ç”Ÿå†…å­˜æ³„æ¼ï¼Ÿ ##

**ç­”æ¡ˆ**ï¼š å› ä¸ºä»–ä»¬ä½¿ç”¨äº†é—­åŒ…ã€‚å¦‚æœä½ åœ¨ç»„ä»¶ä¸­åˆ›å»ºå‡½æ•°ä½†ä¸å–æ¶ˆï¼Œè®¡æ—¶å™¨å¼•ç”¨å°±ä¼šé•¿æœŸä¿ç•™æ—§çš„ DOM å¼•ç”¨æˆ–å˜é‡çŠ¶æ€ã€‚

**è§£å†³æ–¹æ³•**ï¼š

- å°½é‡ä½¿ç”¨ `useCallback`ã€`useRef` ç®¡ç†
- æä¾› `.cancel()` æ¥å£
- åœ¨ç»„ä»¶å¸è½½æ—¶æ¸…ç†

## ğŸ˜€ä¸æ˜¯ç”¨å¯¹äº†ï¼Œè€Œæ˜¯ç”¨å¾—åˆšå¥½ ##

80% çš„äººä½¿ç”¨ `debounce` å’Œ `throttle`ï¼Œåªæ»¡è¶³äº†â€œä¸æŠ¥é”™â€çš„æœ€ä½è¦æ±‚ã€‚

æ‰€ä»¥ï¼Œå†é—®ä½ ä¸€æ¬¡ï¼š

> ä½ æ˜¯çœŸçš„åœ¨ç”¨ debounceï¼Œè¿˜æ˜¯åªæ˜¯åœ¨ copy å®ƒï¼Ÿ
