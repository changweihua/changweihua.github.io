---
layout: doc
# å¼€å¯æ¨è
recommended: true
pageClass: gallery-page-class
title: ç»Ÿä¸€è®¤è¯å¹³å°å®Œå…¨æŒ‡å—-ä»å•ç‚¹ç™»å½•åˆ°ä¼ä¸šçº§å®‰å…¨è®¿é—®çš„æ•°å­—åŒ–åˆ©å™¨
---

## ğŸ“‹ æ‘˜è¦ ##

ç»Ÿä¸€è®¤è¯å¹³å°æ˜¯ä¼ä¸šæ•°å­—åŒ–è½¬å‹æ ¸å¿ƒå®‰å…¨åŸºç¡€è®¾æ–½ï¼Œè§£å†³å¤šç³»ç»Ÿè´¦å·ç®¡ç†æ··ä¹±ã€ç”¨æˆ·é‡å¤ç™»å½•ã€æƒé™åˆ†æ•£ç­‰ç—›ç‚¹ã€‚é€šè¿‡ SSOï¼ˆå•ç‚¹ç™»å½•ï¼‰ã€ç»Ÿä¸€ç”¨æˆ·ç®¡ç†ã€é›†ä¸­æƒé™æ§åˆ¶åŠŸèƒ½ï¼Œå®ç°"ä¸€æ¬¡ç™»å½•ï¼Œå¤šç‚¹é€šè¡Œ"å®‰å…¨è®¿é—®ä½“éªŒã€‚

## ğŸ¯ ä»€ä¹ˆæ˜¯ç»Ÿä¸€è®¤è¯å¹³å° ##

### æ ¸å¿ƒæ¦‚å¿µè§£æ ###

ç»Ÿä¸€è®¤è¯å¹³å°å°±åƒä¸€ä¸ªæ™ºèƒ½é—¨ç¦ç³»ç»Ÿï¼Œæƒ³è±¡ä¸€ä¸‹ï¼š

- ä¼ ç»Ÿæ–¹å¼ï¼šæ¯ä¸ªæˆ¿é—´éƒ½æœ‰ç‹¬ç«‹çš„é—¨é”ï¼Œä½ éœ€è¦æºå¸¦ä¸åŒçš„é’¥åŒ™
- ç»Ÿä¸€è®¤è¯ï¼šä¸€å¼ æ™ºèƒ½å¡å°±èƒ½æ‰“å¼€æ‰€æœ‰æˆæƒæˆ¿é—´çš„é—¨

ç»Ÿä¸€è®¤è¯å¹³å°ï¼ˆUnified Authentication Platformï¼‰æ˜¯ä¸€ä¸ªé›†ä¸­å¼çš„èº«ä»½è®¤è¯ä¸æˆæƒç®¡ç†ç³»ç»Ÿï¼Œä¸ºä¼ä¸šæä¾›ç»Ÿä¸€çš„ç”¨æˆ·èº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶æœåŠ¡ã€‚

### ä¸»è¦ç‰¹å¾ ###

| ç‰¹å¾   |   è¯´æ˜     |   é€‚ç”¨æ°´å¹³ |
| :----------: | :----------: | :---------:  |
| é›†ä¸­ç®¡ç† | ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç”¨æˆ·è´¦å·å’Œæƒé™ | å°ç™½ |
| å•ç‚¹ç™»å½• | ä¸€æ¬¡ç™»å½•è®¿é—®æ‰€æœ‰æˆæƒç³»ç»Ÿ | åˆçº§ |
| å®‰å…¨å¯é  | æ”¯æŒå¤šç§è®¤è¯æ–¹å¼å’Œå®‰å…¨ç­–ç•¥ | ä¸­çº§ |
| æ˜“äºé›†æˆ | æä¾›æ ‡å‡† APIï¼ˆApplication Programming Interfaceï¼Œåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼‰ | é«˜çº§ |

## ğŸš€ ç»Ÿä¸€è®¤è¯å¹³å°çš„æ ¸å¿ƒä»·å€¼ ##

### è§£å†³å¤šç³»ç»Ÿè´¦å·ç®¡ç†æ··ä¹± ###

**é—®é¢˜åœºæ™¯**ï¼š

- å‘˜å·¥éœ€è¦è®°ä½ 10+ ä¸ªä¸åŒç³»ç»Ÿçš„è´¦å·å¯†ç 
- å¯†ç ç­–ç•¥ä¸ç»Ÿä¸€ï¼Œå®‰å…¨é£é™©é«˜
- ç¦»èŒå‘˜å·¥è´¦å·æ¸…ç†å›°éš¾

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// ä¼ ç»Ÿæ–¹å¼ï¼šæ¯ä¸ªç³»ç»Ÿç‹¬ç«‹ç®¡ç†ç”¨æˆ·
class TraditionalUserManagement {
    // ç³»ç»Ÿ A çš„ç”¨æˆ·ç®¡ç†
    public void createUserInSystemA(User user) { /* ... */ }
    
    // ç³»ç»Ÿ B çš„ç”¨æˆ·ç®¡ç†  
    public void createUserInSystemB(User user) { /* ... */ }
    
    // ç³»ç»Ÿ C çš„ç”¨æˆ·ç®¡ç†
    public void createUserInSystemC(User user) { /* ... */ }
}

// ç»Ÿä¸€è®¤è¯æ–¹å¼ï¼šé›†ä¸­ç®¡ç†
class UnifiedUserManagement {
    // ä¸€æ¬¡åˆ›å»ºï¼Œå…¨ç³»ç»Ÿç”Ÿæ•ˆ
    public void createUser(User user) {
        // è‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰æˆæƒç³»ç»Ÿ
        syncToAllSystems(user);
    }
}
```

### æå‡ç”¨æˆ·ä½“éªŒ ###

**ç”Ÿæ´»åŒ–æ¯”å–»**ï¼šå°±åƒä½¿ç”¨å¾®ä¿¡ç™»å½•å„ç§ App ä¸€æ ·ï¼Œä¸éœ€è¦é‡å¤æ³¨å†Œå’Œç™»å½•ã€‚

### é™ä½è¿ç»´æˆæœ¬ ###

- è´¦å·åŒæ­¥ï¼šæ–°å¢ç”¨æˆ·è‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰ç³»ç»Ÿ
- æƒé™ç®¡ç†ï¼šé›†ä¸­è®¾ç½®ç”¨æˆ·æƒé™ï¼Œé¿å…é—æ¼
- å®‰å…¨å®¡è®¡ï¼šç»Ÿä¸€è®°å½•æ‰€æœ‰è®¿é—®æ—¥å¿—

## ğŸ› ï¸ ç»Ÿä¸€è®¤è¯å¹³å°çš„æ ¸å¿ƒåŠŸèƒ½ ##

### å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ ###

**å·¥ä½œåŸç†**ï¼š

```mermaid
graph TD
    A["ç”¨æˆ·è®¿é—®ç³»ç»Ÿ A"] --> B["æ£€æŸ¥ç™»å½•çŠ¶æ€"]
    B --> C{æ˜¯å¦å·²ç™»å½•?}
    C -->|æ˜¯| D["ç›´æ¥è®¿é—®ç³»ç»Ÿ A"]
    C -->|å¦| E["è·³è½¬åˆ°è®¤è¯ä¸­å¿ƒ"]
    E --> F["ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç "]
    F --> G["éªŒè¯æˆåŠŸ"]
    G --> H["ç”Ÿæˆè®¿é—®ä»¤ç‰Œ"]
    H --> I["è·³è½¬å›ç³»ç»Ÿ A"]
    I --> D
    D --> J["ç”¨æˆ·è®¿é—®ç³»ç»Ÿ B"]
    J --> K["æ£€æŸ¥ä»¤ç‰Œ"]
    K --> L["éªŒè¯é€šè¿‡ï¼Œç›´æ¥è®¿é—®"]
```

**é€‚ç”¨æ°´å¹³**ï¼šå°ç™½ - é«˜çº§

### ç»Ÿä¸€ç”¨æˆ·ç®¡ç† ###

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š

- ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šæ³¨å†Œã€æ¿€æ´»ã€ç¦ç”¨ã€åˆ é™¤
- ç”¨æˆ·ä¿¡æ¯åŒæ­¥ï¼šè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰æˆæƒç³»ç»Ÿ
- æ‰¹é‡æ“ä½œï¼šæ”¯æŒæ‰¹é‡å¯¼å…¥ã€å¯¼å‡ºç”¨æˆ·ä¿¡æ¯

**ä»£ç ç¤ºä¾‹**ï¼š

```java
// ç”¨æˆ·ç®¡ç†æ¥å£ç¤ºä¾‹
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // åˆ›å»ºç”¨æˆ· - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
    @PostMapping
    public ResponseEntity<User> createUser(@RequestBody UserDTO userDTO) {
        // åˆ›å»ºç”¨æˆ·å¹¶åŒæ­¥åˆ°æ‰€æœ‰ç³»ç»Ÿ
        User user = userService.createUser(userDTO);
        return ResponseEntity.ok(user);
    }
    
    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
    @PutMapping("/{userId}")
    public ResponseEntity<User> updateUser(@PathVariable String userId, 
                                         @RequestBody UserDTO userDTO) {
        User user = userService.updateUser(userId, userDTO);
        return ResponseEntity.ok(user);
    }
    
    // ç¦ç”¨ç”¨æˆ· - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
    @PutMapping("/{userId}/disable")
    public ResponseEntity<Void> disableUser(@PathVariable String userId) {
        userService.disableUser(userId);
        return ResponseEntity.ok().build();
    }
}
```

### æƒé™ç®¡ç† ###

**æƒé™æ¨¡å‹**ï¼š

- RBACï¼ˆRole-Based Access Controlï¼ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰
- ABACï¼ˆAttribute-Based Access Controlï¼ŒåŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶ï¼‰

**æƒé™ç®¡ç†æµç¨‹**ï¼š

```mermaid
graph LR
    A["ç”¨æˆ·"] --> B["è§’è‰²"]
    B --> C["æƒé™"]
    C --> D["èµ„æº"]
    
    style A fill:#e1f5fe
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
```

### å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰ ###

**è®¤è¯æ–¹å¼**ï¼š

- é™æ€å¯†ç ï¼šä¼ ç»Ÿç”¨æˆ·åå¯†ç 
- åŠ¨æ€å¯†ç ï¼šçŸ­ä¿¡éªŒè¯ç ã€é‚®ä»¶éªŒè¯ç 
- ç”Ÿç‰©è¯†åˆ«ï¼šæŒ‡çº¹ã€äººè„¸è¯†åˆ«
- ç¡¬ä»¶ä»¤ç‰Œï¼šUSB Keyã€æ™ºèƒ½å¡

## ğŸ”Œ ç»Ÿä¸€è®¤è¯å¹³å°æä¾›çš„æ¥å£ ##

### æ ¸å¿ƒæ¥å£æ¸…å• ###

ç»Ÿä¸€è®¤è¯å¹³å°å°±åƒä¸€ä¸ªå¤šåŠŸèƒ½æœåŠ¡å°ï¼Œéœ€è¦æä¾›ä»¥ä¸‹æ ¸å¿ƒæ¥å£ï¼š

| æ¥å£ç±»å‹   |   æ¥å£åç§°     |   åŠŸèƒ½æè¿° |  é€‚ç”¨æ°´å¹³ |
| :----------: | :----------: | :---------:  | :---------:  |
| ç”¨æˆ·è®¤è¯ | ç™»å½•æ¥å£ | éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œè¿”å›è®¿é—®ä»¤ç‰Œ | å°ç™½ |
| ç”¨æˆ·è®¤è¯ | æ³¨å†Œæ¥å£ | åˆ›å»ºæ–°ç”¨æˆ·è´¦å· | å°ç™½ |
| ç”¨æˆ·è®¤è¯ | ç™»å‡ºæ¥å£ | æ¸…é™¤ç”¨æˆ·ä¼šè¯ï¼Œæ³¨é”€ä»¤ç‰Œ | åˆçº§ |
| ä»¤ç‰Œç®¡ç† | Token éªŒè¯æ¥å£ | éªŒè¯è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæ€§ | åˆçº§ |
| ä»¤ç‰Œç®¡ç† | Token åˆ·æ–°æ¥å£ | åˆ·æ–°è¿‡æœŸä»¤ç‰Œ | ä¸­çº§ |
| ç”¨æˆ·ç®¡ç† | ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£ | è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ | åˆçº§ |
| ç”¨æˆ·ç®¡ç† | ç”¨æˆ·ä¿¡æ¯æ›´æ–°æ¥å£ | ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ | ä¸­çº§ |
| æƒé™ç®¡ç† | æƒé™éªŒè¯æ¥å£ | æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šæƒé™ | ä¸­çº§ |
| æƒé™ç®¡ç† | è§’è‰²ç®¡ç†æ¥å£ | ç®¡ç†ç”¨æˆ·è§’è‰²å’Œæƒé™ | é«˜çº§ |
| ç”¨æˆ·æ ‡è¯† | ç”¨æˆ·å”¯ä¸€æ ‡è¯†æ¥å£ | è·å–ç”¨æˆ·è·¨ç³»ç»Ÿå”¯ä¸€æ ‡è¯† | åˆçº§ |

### ç”¨æˆ·å”¯ä¸€æ ‡è¯†çš„é‡è¦æ€§ ###

ç»Ÿä¸€è®¤è¯å¹³å°å°±åƒä¸€ä¸ªèº«ä»½è¯ç³»ç»Ÿï¼Œéœ€è¦ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…ä¸€ä¸ªå”¯ä¸€ä¸”ä¸å˜çš„æ ‡è¯†ï¼ˆå¦‚ openIdã€userIdï¼‰ï¼Œè®©å…¶ä»–ç³»ç»Ÿèƒ½å¤Ÿå‡†ç¡®è¯†åˆ«ç”¨æˆ·èº«ä»½ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼Ÿ ###

- è·¨ç³»ç»Ÿç”¨æˆ·è¯†åˆ«ï¼šä¸åŒç³»ç»Ÿé€šè¿‡åŒä¸€ä¸ªç”¨æˆ·æ ‡è¯†è¯†åˆ«åŒä¸€ä¸ªç”¨æˆ·
- æ•°æ®ä¸€è‡´æ€§ï¼šç¡®ä¿ç”¨æˆ·åœ¨ä¸åŒç³»ç»Ÿä¸­çš„æ•°æ®å…³è”æ­£ç¡®
- æƒé™ç®¡ç†ï¼šåŸºäºç”¨æˆ·æ ‡è¯†è¿›è¡Œç»Ÿä¸€çš„æƒé™æ§åˆ¶
- å®¡è®¡è¿½è¸ªï¼šé€šè¿‡ç”¨æˆ·æ ‡è¯†è¿½è¸ªç”¨æˆ·åœ¨å„ç³»ç»Ÿçš„æ“ä½œè®°å½•

### ç”¨æˆ·å”¯ä¸€æ ‡è¯†æ¥å£ ###

#### è·å–ç”¨æˆ·å”¯ä¸€æ ‡è¯†æ¥å£ï¼ˆUser Unique ID APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åŠŸèƒ½**ï¼šè·å–ç”¨æˆ·åœ¨ç»Ÿä¸€è®¤è¯å¹³å°ä¸­çš„å”¯ä¸€æ ‡è¯†

```java
// è·å–ç”¨æˆ·å”¯ä¸€æ ‡è¯†æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@GetMapping("/user/unique-id")
public ResponseEntity<UserUniqueIdResponse> getUserUniqueId(
        @RequestHeader("Authorization") String token) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯ä»¤ç‰Œå¹¶è·å–ç”¨æˆ·ID
        Claims claims = tokenService.validateToken(accessToken);
        String userId = claims.getSubject();
        
        // è·å–ç”¨æˆ·ä¿¡æ¯
        User user = userService.findById(userId);
        
        if (user != null) {
            UserUniqueIdResponse response = new UserUniqueIdResponse();
            response.setUniqueId(user.getUniqueId());        // ç”¨æˆ·å”¯ä¸€æ ‡è¯†
            response.setUserId(user.getId());                // å†…éƒ¨ç”¨æˆ·ID
            response.setUsername(user.getUsername());        // ç”¨æˆ·å
            response.setOpenId(user.getOpenId());            // å¼€æ”¾å¹³å°ID
            response.setUnionId(user.getUnionId());          // è”åˆIDï¼ˆå¤šåº”ç”¨å…±äº«ï¼‰
            
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(404).build();
        }
        
    } catch (Exception e) {
        return ResponseEntity.status(401).build();
    }
}

// ç”¨æˆ·å”¯ä¸€æ ‡è¯†å“åº”å¯¹è±¡
class UserUniqueIdResponse {
    private String uniqueId;    // ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆä¸»è¦æ ‡è¯†ï¼‰
    private String userId;      // å†…éƒ¨ç”¨æˆ·ID
    private String username;     // ç”¨æˆ·å
    private String openId;      // å¼€æ”¾å¹³å°ID
    private String unionId;     // è”åˆIDï¼ˆå¤šåº”ç”¨å…±äº«ï¼‰
    // getter/setter æ–¹æ³•...
}
```

#### é€šè¿‡å”¯ä¸€æ ‡è¯†æŸ¥è¯¢ç”¨æˆ·æ¥å£ï¼ˆQuery User by Unique ID APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åŠŸèƒ½**ï¼šå…¶ä»–ç³»ç»Ÿé€šè¿‡ç”¨æˆ·å”¯ä¸€æ ‡è¯†æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯

```java
// é€šè¿‡å”¯ä¸€æ ‡è¯†æŸ¥è¯¢ç”¨æˆ·æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@GetMapping("/user/query/{uniqueId}")
public ResponseEntity<UserQueryResponse> queryUserByUniqueId(
        @PathVariable String uniqueId,
        @RequestHeader("Authorization") String token) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯è°ƒç”¨æ–¹æƒé™
        Claims claims = tokenService.validateToken(accessToken);
        String callerUserId = claims.getSubject();
        
        // æ£€æŸ¥è°ƒç”¨æ–¹æ˜¯å¦æœ‰æƒé™æŸ¥è¯¢å…¶ä»–ç”¨æˆ·ä¿¡æ¯
        if (!permissionService.canQueryUserInfo(callerUserId)) {
            return ResponseEntity.status(403).build();
        }
        
        // é€šè¿‡å”¯ä¸€æ ‡è¯†æŸ¥è¯¢ç”¨æˆ·
        User user = userService.findByUniqueId(uniqueId);
        
        if (user != null) {
            UserQueryResponse response = new UserQueryResponse();
            response.setUniqueId(user.getUniqueId());
            response.setUsername(user.getUsername());
            response.setEmail(user.getEmail());
            response.setStatus(user.getStatus());
            response.setRoles(user.getRoles());
            response.setLastLoginTime(user.getLastLoginTime());
            
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(404).body(new UserQueryResponse("ç”¨æˆ·ä¸å­˜åœ¨"));
        }
        
    } catch (Exception e) {
        return ResponseEntity.status(401).build();
    }
}

// ç”¨æˆ·æŸ¥è¯¢å“åº”å¯¹è±¡
class UserQueryResponse {
    private String uniqueId;        // ç”¨æˆ·å”¯ä¸€æ ‡è¯†
    private String username;        // ç”¨æˆ·å
    private String email;           // é‚®ç®±
    private String status;          // ç”¨æˆ·çŠ¶æ€
    private List<String> roles;     // ç”¨æˆ·è§’è‰²
    private Date lastLoginTime;     // æœ€åç™»å½•æ—¶é—´
    private String message;         // æ¶ˆæ¯
    // getter/setter æ–¹æ³•...
}
```

#### ç”¨æˆ·å”¯ä¸€æ ‡è¯†ç”Ÿæˆç­–ç•¥ ####

**é€‚ç”¨æ°´å¹³**ï¼šä¸­çº§

**åŠŸèƒ½**ï¼šç¡®ä¿ç”¨æˆ·å”¯ä¸€æ ‡è¯†çš„å”¯ä¸€æ€§å’Œä¸å˜æ€§

```java
// ç”¨æˆ·å”¯ä¸€æ ‡è¯†ç”ŸæˆæœåŠ¡ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@Service
public class UserUniqueIdService {
    
    // ç”Ÿæˆç”¨æˆ·å”¯ä¸€æ ‡è¯†
    public String generateUniqueId(User user) {
        // ç­–ç•¥1ï¼šåŸºäºç”¨æˆ·ä¿¡æ¯ç”Ÿæˆï¼ˆæ¨èï¼‰
        String baseInfo = user.getUsername() + user.getEmail() + user.getCreateTime();
        String hash = DigestUtils.sha256Hex(baseInfo);
        return "user_" + hash.substring(0, 16);
        
        // ç­–ç•¥2ï¼šä½¿ç”¨UUIDï¼ˆå¤‡é€‰ï¼‰
        // return "user_" + UUID.randomUUID().toString().replace("-", "");
        
        // ç­–ç•¥3ï¼šåŸºäºæ—¶é—´æˆ³å’Œéšæœºæ•°ï¼ˆå¤‡é€‰ï¼‰
        // return "user_" + System.currentTimeMillis() + "_" + RandomUtils.nextInt(1000, 9999);
    }
    
    // éªŒè¯å”¯ä¸€æ ‡è¯†æ ¼å¼
    public boolean isValidUniqueId(String uniqueId) {
        return uniqueId != null && 
               uniqueId.startsWith("user_") && 
               uniqueId.length() == 21; // user_ + 16ä½hash
    }
    
    // æ£€æŸ¥å”¯ä¸€æ ‡è¯†æ˜¯å¦å·²å­˜åœ¨
    public boolean isUniqueIdExists(String uniqueId) {
        return userService.existsByUniqueId(uniqueId);
    }
}
```

### ç”¨æˆ·è®¤è¯æ ¸å¿ƒæ¥å£ ###

#### ç™»å½•æ¥å£ï¼ˆLogin APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šå°ç™½

**åŠŸèƒ½**ï¼šéªŒè¯ç”¨æˆ·èº«ä»½ï¼Œè¿”å›è®¿é—®ä»¤ç‰Œ

```java
// ç™»å½•æ¥å£ç¤ºä¾‹
@RestController
@RequestMapping("/api/auth")
public class AuthController {
    
    // ç”¨æˆ·ç™»å½• - é€‚ç”¨æ°´å¹³ï¼šå°ç™½
    @PostMapping("/login")
    public ResponseEntity<LoginResponse> login(@RequestBody LoginRequest request) {
        // éªŒè¯ç”¨æˆ·åå’Œå¯†ç 
        User user = userService.authenticate(request.getUsername(), request.getPassword());
        
        if (user != null) {
            // ç”Ÿæˆè®¿é—®ä»¤ç‰Œ
            String accessToken = tokenService.generateAccessToken(user);
            String refreshToken = tokenService.generateRefreshToken(user);
            
            LoginResponse response = new LoginResponse();
            response.setAccessToken(accessToken);
            response.setRefreshToken(refreshToken);
            response.setExpiresIn(3600); // 1å°æ—¶è¿‡æœŸ
            response.setTokenType("Bearer");
            
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(401).build();
        }
    }
}

// ç™»å½•è¯·æ±‚å¯¹è±¡
class LoginRequest {
    private String username;  // ç”¨æˆ·å
    private String password;  // å¯†ç 
    // getter/setter æ–¹æ³•...
}

// ç™»å½•å“åº”å¯¹è±¡
class LoginResponse {
    private String accessToken;   // è®¿é—®ä»¤ç‰Œ
    private String refreshToken;  // åˆ·æ–°ä»¤ç‰Œ
    private int expiresIn;        // è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    private String tokenType;     // ä»¤ç‰Œç±»å‹
    // getter/setter æ–¹æ³•...
}
```

#### æ³¨å†Œæ¥å£ï¼ˆRegister APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šå°ç™½

**åŠŸèƒ½**ï¼šåˆ›å»ºæ–°ç”¨æˆ·è´¦å·

```java
// ç”¨æˆ·æ³¨å†Œæ¥å£ - é€‚ç”¨æ°´å¹³ï¼šå°ç™½
@PostMapping("/register")
public ResponseEntity<RegisterResponse> register(@RequestBody RegisterRequest request) {
    // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
    if (userService.existsByUsername(request.getUsername())) {
        return ResponseEntity.status(409).body(new RegisterResponse("ç”¨æˆ·åå·²å­˜åœ¨"));
    }
    
    // åˆ›å»ºæ–°ç”¨æˆ·
    User newUser = new User();
    newUser.setUsername(request.getUsername());
    newUser.setPassword(passwordEncoder.encode(request.getPassword()));
    newUser.setEmail(request.getEmail());
    newUser.setStatus("ACTIVE");
    
    User savedUser = userService.save(newUser);
    
    // åˆ†é…é»˜è®¤è§’è‰²
    roleService.assignDefaultRole(savedUser.getId());
    
    return ResponseEntity.ok(new RegisterResponse("æ³¨å†ŒæˆåŠŸ", savedUser.getId()));
}

// æ³¨å†Œè¯·æ±‚å¯¹è±¡
class RegisterRequest {
    private String username;  // ç”¨æˆ·å
    private String password;  // å¯†ç 
    private String email;      // é‚®ç®±
    // getter/setter æ–¹æ³•...
}
```

#### ç™»å‡ºæ¥å£ï¼ˆLogout APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åŠŸèƒ½**ï¼šæ¸…é™¤ç”¨æˆ·ä¼šè¯ï¼Œæ³¨é”€ä»¤ç‰Œ

```java
// ç”¨æˆ·ç™»å‡ºæ¥å£ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@PostMapping("/logout")
public ResponseEntity<Void> logout(@RequestHeader("Authorization") String token) {
    // æå–ä»¤ç‰Œ
    String accessToken = token.replace("Bearer ", "");
    
    // å°†ä»¤ç‰ŒåŠ å…¥é»‘åå•
    tokenService.blacklistToken(accessToken);
    
    // æ¸…é™¤ç”¨æˆ·ä¼šè¯
    sessionService.clearUserSession(accessToken);
    
    return ResponseEntity.ok().build();
}
```

### ä»¤ç‰Œç®¡ç†æ ¸å¿ƒæ¥å£ ###

#### Token éªŒè¯æ¥å£ï¼ˆToken Validation APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åŠŸèƒ½**ï¼šéªŒè¯è®¿é—®ä»¤ç‰Œæœ‰æ•ˆæ€§

```java
// Token éªŒè¯æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@GetMapping("/validate")
public ResponseEntity<TokenValidationResponse> validateToken(
        @RequestHeader("Authorization") String token) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯ä»¤ç‰Œæ˜¯å¦åœ¨é»‘åå•ä¸­
        if (tokenService.isTokenBlacklisted(accessToken)) {
            return ResponseEntity.status(401).body(new TokenValidationResponse(false, "ä»¤ç‰Œå·²å¤±æ•ˆ"));
        }
        
        // éªŒè¯ä»¤ç‰Œç­¾åå’Œè¿‡æœŸæ—¶é—´
        Claims claims = tokenService.validateToken(accessToken);
        
        if (claims != null) {
            TokenValidationResponse response = new TokenValidationResponse();
            response.setValid(true);
            response.setUserId(claims.getSubject());
            response.setExpiresAt(claims.getExpiration());
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(401).body(new TokenValidationResponse(false, "ä»¤ç‰Œæ— æ•ˆ"));
        }
        
    } catch (Exception e) {
        return ResponseEntity.status(401).body(new TokenValidationResponse(false, "ä»¤ç‰ŒéªŒè¯å¤±è´¥"));
    }
}

// Token éªŒè¯å“åº”å¯¹è±¡
class TokenValidationResponse {
    private boolean valid;        // æ˜¯å¦æœ‰æ•ˆ
    private String userId;        // ç”¨æˆ·ID
    private Date expiresAt;       // è¿‡æœŸæ—¶é—´
    private String message;       // æ¶ˆæ¯
    // getter/setter æ–¹æ³•...
}
```

#### Token åˆ·æ–°æ¥å£ï¼ˆToken Refresh APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šä¸­çº§

**åŠŸèƒ½**ï¼šåˆ·æ–°è¿‡æœŸä»¤ç‰Œ

```java
// Token åˆ·æ–°æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@PostMapping("/refresh")
public ResponseEntity<RefreshTokenResponse> refreshToken(@RequestBody RefreshTokenRequest request) {
    
    String refreshToken = request.getRefreshToken();
    
    try {
        // éªŒè¯åˆ·æ–°ä»¤ç‰Œ
        Claims claims = tokenService.validateRefreshToken(refreshToken);
        
        if (claims != null) {
            String userId = claims.getSubject();
            
            // ç”Ÿæˆæ–°çš„è®¿é—®ä»¤ç‰Œ
            String newAccessToken = tokenService.generateAccessToken(userId);
            
            RefreshTokenResponse response = new RefreshTokenResponse();
            response.setAccessToken(newAccessToken);
            response.setExpiresIn(3600);
            response.setTokenType("Bearer");
            
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(401).body(new RefreshTokenResponse("åˆ·æ–°ä»¤ç‰Œæ— æ•ˆ"));
        }
        
    } catch (Exception e) {
        return ResponseEntity.status(401).body(new RefreshTokenResponse("åˆ·æ–°ä»¤ç‰Œå¤±è´¥"));
    }
}
```

### ç”¨æˆ·ç®¡ç†æ ¸å¿ƒæ¥å£ ###

#### ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£ï¼ˆUser Info APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åŠŸèƒ½**ï¼šè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯

```java
// ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@GetMapping("/user/info")
public ResponseEntity<UserInfoResponse> getUserInfo(@RequestHeader("Authorization") String token) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯ä»¤ç‰Œå¹¶è·å–ç”¨æˆ·ID
        Claims claims = tokenService.validateToken(accessToken);
        String userId = claims.getSubject();
        
        // æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
        User user = userService.findById(userId);
        
        if (user != null) {
            UserInfoResponse response = new UserInfoResponse();
            response.setUserId(user.getId());
            response.setUsername(user.getUsername());
            response.setEmail(user.getEmail());
            response.setRoles(user.getRoles());
            response.setStatus(user.getStatus());
            
            return ResponseEntity.ok(response);
        } else {
            return ResponseEntity.status(404).build();
        }
        
    } catch (Exception e) {
        return ResponseEntity.status(401).build();
    }
}
```

#### ç”¨æˆ·ä¿¡æ¯æ›´æ–°æ¥å£ï¼ˆUser Update APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šä¸­çº§

**åŠŸèƒ½**ï¼šä¿®æ”¹ç”¨æˆ·ä¿¡æ¯

```java
// ç”¨æˆ·ä¿¡æ¯æ›´æ–°æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@PutMapping("/user/update")
public ResponseEntity<UserUpdateResponse> updateUserInfo(
        @RequestHeader("Authorization") String token,
        @RequestBody UserUpdateRequest request) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯ä»¤ç‰Œå¹¶è·å–ç”¨æˆ·ID
        Claims claims = tokenService.validateToken(accessToken);
        String userId = claims.getSubject();
        
        // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
        User user = userService.findById(userId);
        user.setEmail(request.getEmail());
        user.setPhone(request.getPhone());
        user.setNickname(request.getNickname());
        
        User updatedUser = userService.save(user);
        
        return ResponseEntity.ok(new UserUpdateResponse("æ›´æ–°æˆåŠŸ", updatedUser));
        
    } catch (Exception e) {
        return ResponseEntity.status(500).body(new UserUpdateResponse("æ›´æ–°å¤±è´¥", null));
    }
}
```

### æƒé™ç®¡ç†æ ¸å¿ƒæ¥å£ ###

#### æƒé™éªŒè¯æ¥å£ï¼ˆPermission Check APIï¼‰ ####

**é€‚ç”¨æ°´å¹³**ï¼šä¸­çº§

**åŠŸèƒ½**ï¼šæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰ç‰¹å®šæƒé™

```java
// æƒé™éªŒè¯æ¥å£ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@PostMapping("/permission/check")
public ResponseEntity<PermissionCheckResponse> checkPermission(
        @RequestHeader("Authorization") String token,
        @RequestBody PermissionCheckRequest request) {
    
    String accessToken = token.replace("Bearer ", "");
    
    try {
        // éªŒè¯ä»¤ç‰Œå¹¶è·å–ç”¨æˆ·ID
        Claims claims = tokenService.validateToken(accessToken);
        String userId = claims.getSubject();
        
        // æ£€æŸ¥ç”¨æˆ·æƒé™
        boolean hasPermission = permissionService.checkUserPermission(
            userId, 
            request.getResource(), 
            request.getAction()
        );
        
        PermissionCheckResponse response = new PermissionCheckResponse();
        response.setHasPermission(hasPermission);
        response.setUserId(userId);
        response.setResource(request.getResource());
        response.setAction(request.getAction());
        
        return ResponseEntity.ok(response);
        
    } catch (Exception e) {
        return ResponseEntity.status(401).build();
    }
}

// æƒé™æ£€æŸ¥è¯·æ±‚å¯¹è±¡
class PermissionCheckRequest {
    private String resource;  // èµ„æºåç§°
    private String action;    // æ“ä½œç±»å‹ï¼ˆread, write, deleteç­‰ï¼‰
    // getter/setter æ–¹æ³•...
}
```

### æ¥å£è°ƒç”¨æµç¨‹å›¾ ###

ç»Ÿä¸€è®¤è¯å¹³å°çš„æ¥å£è°ƒç”¨å°±åƒä¸€ä¸ªæ™ºèƒ½æœåŠ¡æµç¨‹ï¼š

```mermaid
graph TD
    A["ç”¨æˆ·è®¿é—®åº”ç”¨"] --> B["æ£€æŸ¥ç™»å½•çŠ¶æ€"]
    B --> C{æ˜¯å¦å·²ç™»å½•?}
    C -->|å¦| D["è°ƒç”¨ç™»å½•æ¥å£"]
    D --> E["éªŒè¯ç”¨æˆ·åå¯†ç "]
    E --> F{éªŒè¯æˆåŠŸ?}
    F -->|æ˜¯| G["è¿”å›è®¿é—®ä»¤ç‰Œ"]
    F -->|å¦| H["è¿”å›é”™è¯¯ä¿¡æ¯"]
    G --> I["å­˜å‚¨ä»¤ç‰Œåˆ°æœ¬åœ°"]
    I --> J["è°ƒç”¨ Token éªŒè¯æ¥å£"]
    J --> K{ä»¤ç‰Œæœ‰æ•ˆ?}
    K -->|æ˜¯| L["è°ƒç”¨ç”¨æˆ·å”¯ä¸€æ ‡è¯†æ¥å£"]
    K -->|å¦| M["è°ƒç”¨ Token åˆ·æ–°æ¥å£"]
    M --> N{åˆ·æ–°æˆåŠŸ?}
    N -->|æ˜¯| O["è·å–æ–°ä»¤ç‰Œ"]
    N -->|å¦| P["é‡æ–°ç™»å½•"]
    O --> L
    C -->|æ˜¯| J
    L --> Q["è·å–ç”¨æˆ·å”¯ä¸€æ ‡è¯†"]
    Q --> R["è°ƒç”¨æƒé™éªŒè¯æ¥å£"]
    R --> S{æœ‰æƒé™?}
    S -->|æ˜¯| T["æ‰§è¡Œæ“ä½œ"]
    S -->|å¦| U["è¿”å›æƒé™ä¸è¶³"]
    
    style A fill:#e1f5fe
    style G fill:#e8f5e8
    style L fill:#fff3e0
    style Q fill:#f3e5f5
    style T fill:#e8f5e8
```

### è®¤è¯åè®®æ¥å£ ###

#### OAuth 2.0ï¼ˆOpen Authorization 2.0ï¼Œå¼€æ”¾æˆæƒ 2.0ï¼‰ ####

**é€‚ç”¨åœºæ™¯**ï¼šç¬¬ä¸‰æ–¹åº”ç”¨æˆæƒè®¿é—®

```java
// OAuth 2.0 æˆæƒç æ¨¡å¼ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@RestController
@RequestMapping("/oauth")
public class OAuthController {
    
    // è·å–æˆæƒç 
    @GetMapping("/authorize")
    public ResponseEntity<String> authorize(@RequestParam String clientId,
                                          @RequestParam String redirectUri) {
        // ç”Ÿæˆæˆæƒç 
        String authCode = oauthService.generateAuthCode(clientId, redirectUri);
        return ResponseEntity.ok(authCode);
    }
    
    // äº¤æ¢è®¿é—®ä»¤ç‰Œ
    @PostMapping("/token")
    public ResponseEntity<TokenResponse> getToken(@RequestBody TokenRequest request) {
        TokenResponse token = oauthService.exchangeToken(request);
        return ResponseEntity.ok(token);
    }
}
```

#### SAML 2.0ï¼ˆSecurity Assertion Markup Language 2.0ï¼Œå®‰å…¨æ–­è¨€æ ‡è®°è¯­è¨€ 2.0ï¼‰ ####

**é€‚ç”¨åœºæ™¯**ï¼šä¼ä¸šçº§å•ç‚¹ç™»å½•

#### CASï¼ˆCentral Authentication Serviceï¼Œä¸­å¤®è®¤è¯æœåŠ¡ï¼‰ ####

**é€‚ç”¨åœºæ™¯**ï¼šå†…éƒ¨ç³»ç»Ÿé›†æˆ

### RESTful APIï¼ˆRepresentational State Transfer APIï¼Œè¡¨è¿°æ€§çŠ¶æ€è½¬ç§» APIï¼‰ ###

#### ç”¨æˆ·ç®¡ç†æ¥å£ ####

```java
// ç”¨æˆ·ç®¡ç† API ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šåˆçº§
@RestController
@RequestMapping("/api/v1/users")
public class UserManagementAPI {
    
    // è·å–ç”¨æˆ·ä¿¡æ¯
    @GetMapping("/{userId}")
    public ResponseEntity<UserInfo> getUserInfo(@PathVariable String userId) {
        UserInfo user = userService.getUserById(userId);
        return ResponseEntity.ok(user);
    }
    
    // éªŒè¯ç”¨æˆ·èº«ä»½
    @PostMapping("/authenticate")
    public ResponseEntity<AuthResult> authenticate(@RequestBody AuthRequest request) {
        AuthResult result = authService.authenticate(request);
        return ResponseEntity.ok(result);
    }
    
    // è·å–ç”¨æˆ·æƒé™
    @GetMapping("/{userId}/permissions")
    public ResponseEntity<List<Permission>> getUserPermissions(@PathVariable String userId) {
        List<Permission> permissions = permissionService.getUserPermissions(userId);
        return ResponseEntity.ok(permissions);
    }
}
```

#### æƒé™ç®¡ç†æ¥å£ ####

```java
// æƒé™ç®¡ç† API ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@RestController
@RequestMapping("/api/v1/permissions")
public class PermissionAPI {
    
    // æ£€æŸ¥ç”¨æˆ·æƒé™
    @PostMapping("/check")
    public ResponseEntity<PermissionCheckResult> checkPermission(
            @RequestBody PermissionCheckRequest request) {
        PermissionCheckResult result = permissionService.checkPermission(request);
        return ResponseEntity.ok(result);
    }
    
    // è·å–è§’è‰²æƒé™
    @GetMapping("/roles/{roleId}")
    public ResponseEntity<List<Permission>> getRolePermissions(@PathVariable String roleId) {
        List<Permission> permissions = roleService.getRolePermissions(roleId);
        return ResponseEntity.ok(permissions);
    }
}
```

### èº«ä»½æºé›†æˆæ¥å£ ###

#### LDAPï¼ˆLightweight Directory Access Protocolï¼Œè½»é‡çº§ç›®å½•è®¿é—®åè®®ï¼‰é›†æˆ ####

```java
// LDAP é›†æˆç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šé«˜çº§
@Service
public class LDAPIntegrationService {
    
    // åŒæ­¥ LDAP ç”¨æˆ·
    @Scheduled(fixedRate = 3600000) // æ¯å°æ—¶åŒæ­¥ä¸€æ¬¡
    public void syncLDAPUsers() {
        List<LDAPUser> ldapUsers = ldapService.getAllUsers();
        for (LDAPUser ldapUser : ldapUsers) {
            userService.syncUser(ldapUser);
        }
    }
    
    // éªŒè¯ LDAP ç”¨æˆ·
    public boolean authenticateLDAPUser(String username, String password) {
        return ldapService.authenticate(username, password);
    }
}
```

#### Active Directoryï¼ˆADï¼Œæ´»åŠ¨ç›®å½•ï¼‰é›†æˆ ####

#### ç¬¬ä¸‰æ–¹èº«ä»½æºé›†æˆï¼ˆé’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ç­‰ï¼‰ ####

## ğŸ¯ å®é™…åº”ç”¨åœºæ™¯ ##

### åœºæ™¯ä¸€ï¼šä¼ä¸šå†…éƒ¨ç³»ç»Ÿé›†æˆ ###

**é€‚ç”¨æ°´å¹³**ï¼šåˆçº§

**åœºæ™¯æè¿°**ï¼šæŸå…¬å¸æœ‰ HRï¼ˆHuman Resourcesï¼ŒäººåŠ›èµ„æºï¼‰ç³»ç»Ÿã€è´¢åŠ¡ç³»ç»Ÿã€é¡¹ç›®ç®¡ç†ç³»ç»Ÿç­‰å¤šä¸ªå†…éƒ¨ç³»ç»Ÿã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// ä¼ä¸šå†…éƒ¨ç³»ç»Ÿé›†æˆç¤ºä¾‹
@Component
public class InternalSystemIntegration {
    
    // ç”¨æˆ·ç™»å½•åè‡ªåŠ¨åŒæ­¥åˆ°æ‰€æœ‰ç³»ç»Ÿ
    @EventListener
    public void handleUserLogin(UserLoginEvent event) {
        // åŒæ­¥åˆ° HR ç³»ç»Ÿ
        hrSystemService.syncUser(event.getUser());
        
        // åŒæ­¥åˆ°è´¢åŠ¡ç³»ç»Ÿ
        financeSystemService.syncUser(event.getUser());
        
        // åŒæ­¥åˆ°é¡¹ç›®ç®¡ç†ç³»ç»Ÿ
        projectSystemService.syncUser(event.getUser());
    }
}
```

### åœºæ™¯äºŒï¼šå¤šç§Ÿæˆ· SaaSï¼ˆSoftware as a Serviceï¼Œè½¯ä»¶å³æœåŠ¡ï¼‰å¹³å° ###

**é€‚ç”¨æ°´å¹³**ï¼šä¸­çº§

**åœºæ™¯æè¿°**ï¼šä¸ºä¸åŒä¼ä¸šå®¢æˆ·æä¾›ç»Ÿä¸€è®¤è¯æœåŠ¡ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// å¤šç§Ÿæˆ·è®¤è¯ç¤ºä¾‹
@Service
public class MultiTenantAuthService {
    
    // æ ¹æ®ç§Ÿæˆ· ID è·å–è®¤è¯é…ç½®
    public AuthConfig getAuthConfig(String tenantId) {
        return tenantService.getAuthConfig(tenantId);
    }
    
    // ç§Ÿæˆ·éš”ç¦»çš„ç”¨æˆ·è®¤è¯
    public AuthResult authenticate(String tenantId, AuthRequest request) {
        AuthConfig config = getAuthConfig(tenantId);
        return authService.authenticateWithConfig(request, config);
    }
}
```

### åœºæ™¯ä¸‰ï¼šè·¨ç»„ç»‡åä½œå¹³å° ###

**é€‚ç”¨æ°´å¹³**ï¼šé«˜çº§

**åœºæ™¯æè¿°**ï¼šä¸åŒä¼ä¸šé—´çš„ä¸šåŠ¡åä½œéœ€è¦å®‰å…¨çš„èº«ä»½è®¤è¯ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// è·¨ç»„ç»‡è®¤è¯ç¤ºä¾‹
@Service
public class CrossOrganizationAuthService {
    
    // è”é‚¦è®¤è¯
    public AuthResult federatedAuth(String organizationId, AuthRequest request) {
        // éªŒè¯ç»„ç»‡èº«ä»½
        Organization org = organizationService.getById(organizationId);
        
        // æ‰§è¡Œè”é‚¦è®¤è¯
        return federationService.authenticate(org, request);
    }
}
```

## âš ï¸ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ ##

### é—®é¢˜ä¸€ï¼šè®¤è¯å¤±è´¥ç‡é«˜ ###

**åŸå› åˆ†æ**ï¼š

- å¯†ç ç­–ç•¥è¿‡äºä¸¥æ ¼
- ç½‘ç»œå»¶è¿Ÿå¯¼è‡´è¶…æ—¶
- ç”¨æˆ·è¾“å…¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š

```java
// è®¤è¯å¤±è´¥å¤„ç†ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@Service
public class AuthFailureHandler {
    
    // è®°å½•è®¤è¯å¤±è´¥æ—¥å¿—
    public void handleAuthFailure(String username, String reason) {
        AuthFailureLog log = new AuthFailureLog(username, reason, new Date());
        authLogService.save(log);
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦é”å®šè´¦å·
        checkAccountLock(username);
    }
    
    // æ™ºèƒ½é‡è¯•æœºåˆ¶
    public AuthResult retryAuth(AuthRequest request) {
        int retryCount = 0;
        while (retryCount < 3) {
            try {
                return authService.authenticate(request);
            } catch (AuthException e) {
                retryCount++;
                if (retryCount >= 3) {
                    throw e;
                }
                // ç­‰å¾…åé‡è¯•
                Thread.sleep(1000);
            }
        }
        return null;
    }
}
```

### é—®é¢˜äºŒï¼šç³»ç»Ÿé›†æˆå¤æ‚ ###

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ä½¿ç”¨æ ‡å‡†åè®®ï¼ˆOAuth 2.0ã€SAML 2.0ï¼‰
- æä¾› SDKï¼ˆSoftware Development Kitï¼Œè½¯ä»¶å¼€å‘å·¥å…·åŒ…ï¼‰
- è¯¦ç»†çš„é›†æˆæ–‡æ¡£

### é—®é¢˜ä¸‰ï¼šæ€§èƒ½ç“¶é¢ˆ ###

**è§£å†³æ–¹æ¡ˆ**ï¼š

- ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
- å¼‚æ­¥å¤„ç†è®¤è¯è¯·æ±‚
- è´Ÿè½½å‡è¡¡

## ğŸ† æœ€ä½³å®è·µå»ºè®® ##

### å®‰å…¨æœ€ä½³å®è·µ ###

```java
// å®‰å…¨é…ç½®ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        // ä½¿ç”¨ BCrypt åŠ å¯†
        return new BCryptPasswordEncoder(12);
    }
    
    @Bean
    public AuthenticationManager authenticationManager() {
        return new ProviderManager(Arrays.asList(
            new UsernamePasswordAuthenticationProvider(),
            new MFAuthenticationProvider()
        ));
    }
}
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®® ###

- ç¼“å­˜ç­–ç•¥ï¼šç¼“å­˜ç”¨æˆ·ä¿¡æ¯å’Œæƒé™æ•°æ®
- è¿æ¥æ± ï¼šä½¿ç”¨æ•°æ®åº“è¿æ¥æ± 
- å¼‚æ­¥å¤„ç†ï¼šå¼‚æ­¥å¤„ç†æ—¥å¿—è®°å½•

### ç›‘æ§å’Œå®¡è®¡ ###

```java
// å®¡è®¡æ—¥å¿—ç¤ºä¾‹ - é€‚ç”¨æ°´å¹³ï¼šä¸­çº§
@Component
public class AuditLogger {
    
    // è®°å½•ç”¨æˆ·æ“ä½œ
    public void logUserAction(String userId, String action, String resource) {
        AuditLog log = new AuditLog(userId, action, resource, new Date());
        auditService.save(log);
    }
    
    // è®°å½•è®¤è¯äº‹ä»¶
    public void logAuthEvent(String userId, AuthEventType eventType) {
        AuthEvent event = new AuthEvent(userId, eventType, new Date());
        authEventService.save(event);
    }
}
```

## ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®® ##

### å°ç™½ï¼ˆé›¶åŸºç¡€ï¼‰ ###

- äº†è§£åŸºæœ¬æ¦‚å¿µï¼šç”¨æˆ·ã€è§’è‰²ã€æƒé™
- å­¦ä¹  HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰åè®®åŸºç¡€
- ç†è§£ RESTful API æ¦‚å¿µ

### åˆçº§å¼€å‘è€… ###

- å­¦ä¹  OAuth 2.0 åŸºç¡€
- æŒæ¡ JWTï¼ˆJSON Web Tokenï¼ŒJSON ç½‘ç»œä»¤ç‰Œï¼‰ä½¿ç”¨
- äº†è§£ Spring Security åŸºç¡€

### ä¸­çº§å¼€å‘è€… ###

- æ·±å…¥å­¦ä¹  SAML 2.0 åè®®
- æŒæ¡å¤šå› ç´ è®¤è¯å®ç°
- å­¦ä¹ å¾®æœåŠ¡æ¶æ„ä¸‹çš„è®¤è¯

### é«˜çº§å¼€å‘è€… ###

- ç ”ç©¶è”é‚¦è®¤è¯ï¼ˆFederated Authenticationï¼‰
- æŒæ¡é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹
- å­¦ä¹ äº‘åŸç”Ÿè®¤è¯æ¶æ„

## ğŸ‰ æ€»ç»“ ##

ç»Ÿä¸€è®¤è¯å¹³å°æ˜¯ç°ä»£ä¼ä¸šæ•°å­—åŒ–è½¬å‹çš„é‡è¦åŸºç¡€è®¾æ–½ï¼Œé€šè¿‡é›†ä¸­åŒ–çš„èº«ä»½ç®¡ç†å’Œå•ç‚¹ç™»å½•åŠŸèƒ½ï¼Œä¸ä»…å¤§å¹…æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œè¿˜æ˜¾è‘—é™ä½äº†ä¼ä¸šçš„è¿ç»´æˆæœ¬å’Œå®‰å…¨éšæ‚£ã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š

- âœ… ä¸€æ¬¡ç™»å½•ï¼Œå¤šç‚¹é€šè¡Œ - è§£å†³å¤šç³»ç»Ÿè´¦å·ç®¡ç†éš¾é¢˜
- âœ… é›†ä¸­ç®¡ç†ï¼Œç»Ÿä¸€æ§åˆ¶ - æå‡å®‰å…¨æ€§å’Œç®¡ç†æ•ˆç‡
- âœ… æ ‡å‡†æ¥å£ï¼Œæ˜“äºé›†æˆ - æ”¯æŒå¤šç§è®¤è¯åè®®å’Œèº«ä»½æº
- âœ… å®‰å…¨å¯é ï¼Œå®¡è®¡å®Œæ•´ - æ»¡è¶³ä¼ä¸šçº§å®‰å…¨è¦æ±‚
